(function(){var e;e=["widgetCore","widgetCore.translate","ngAnimate"],function(e){"use strict";return e}(angular.module("comboWidget",e))}).call(this),function(){"use strict";function e(t,o,s,n,r){angular.extend(e,n("widgetCoreController",{$scope:t})),t.defaultArgs={filter:"football/all/all/",defaultListLimit:3,selectionLimit:12},t.betoffers=[],t.events=[],t.defaultHeight=450,t.currentHeight=450,t.rowHeight=115,t.listLimit=3,t.lowerOddsLimit=2,t.getBetoffersByFilter=function(e){t.loading=!0;var o={lang:"en_GB",market:"SE",client_id:null,include:null,callback:"JSON_CALLBACK"};return r.jsonp("https://cti-api.kambi.com/offering/api/v3/leo/listView/football/all/all/",{params:o,cache:!1}).then(function(e){t.events=[];for(var o=t.sortEventOffers(e.data.events),s=0,n=o.length,r=0,i=[];n>s;++s){var f=!1;null!=o[s].event.homeName&&(-1===i.indexOf(o[s].event.homeName)?i.push(o[s].event.homeName):f=!0),null!=o[s].event.awayName&&(-1===i.indexOf(o[s].event.awayName)?i.push(o[s].event.awayName):f=!0),f||(r<t.listLimit&&(o[s].betOffers[0].outcomes[o[s].betOffers[0].lowestOutcome].selected=!0,r+=1),t.events.push(o[s]))}t.calculateCombinedOdds()},function(e){})["finally"](function(){t.loading=!1})},t.sortEventOffers=function(e){for(var o=0,s=e.length,n=[];s>o;++o)if(null!=e[o].betOffers[0]&&null!=e[o].betOffers[0].outcomes&&e[o].betOffers[0].outcomes.length>0&&e[o].betOffers[0].outcomes.length<=3){for(var r=1,i=e[o].betOffers[0].outcomes.length,f=0;i>r;++r)e[o].betOffers[0].outcomes[r].odds<e[o].betOffers[0].outcomes[f].odds&&(f=r);e[o].betOffers[0].lowestOutcome=f,n.push(e[o])}return t.quickSortBetEvents(n)},t.quickSortBetEvents=function(e,o,s){function n(e,t,o){var s=e[t];e[t]=e[o],e[o]=s}function r(e,t,o){for(var s=e[Math.floor((o+t)/2)],r=t,i=o;i>=r;){for(;e[r].betOffers[0].outcomes[e[r].betOffers[0].lowestOutcome].odds<s.betOffers[0].outcomes[s.betOffers[0].lowestOutcome].odds;)r++;for(;e[i].betOffers[0].outcomes[e[i].betOffers[0].lowestOutcome].odds>s.betOffers[0].outcomes[s.betOffers[0].lowestOutcome].odds;)i--;i>=r&&(n(e,r,i),r++,i--)}return r}var i;return e.length>1&&(o="number"!=typeof o?0:o,s="number"!=typeof s?e.length-1:s,i=r(e,o,s),i-1>o&&t.quickSortBetEvents(e,o,i-1),s>i&&t.quickSortBetEvents(e,i,s)),e},t.calculateCombinedOdds=function(){var e=0,o=1,s=[];if(t.events.length>0){for(;e<t.listLimit;++e)for(var n=0,r=t.events[e].betOffers[0].outcomes.length;r>n;++n)t.events[e].betOffers[0].outcomes[n].selected&&s.push(t.events[e].betOffers[0].outcomes[n]);o=t.multiplyOdds(s)}else o="";t.combinedOdds=o},t.addOutcomesToBetslip=function(){for(var e=0,s=[];e<t.listLimit;++e)for(var n=0,r=t.events[e].betOffers[0].outcomes.length;r>n;++n)t.events[e].betOffers[0].outcomes[n].selected&&s.push(t.events[e].betOffers[0].outcomes[n].id);o.addOutcomeToBetslip(s)},t.selectNextOutcome=function(){for(var e=0,o=t.events.length,s=0,n=0;o>e;++e){for(var r=0,i=t.events[e].betOffers[0].outcomes.length,f=!1;i>r;++r)t.events[e].betOffers[0].outcomes[r].selected===!0&&(f=!0,n+=1);if(n>=t.args.selectionLimit)return!1;if(f===!1)return s===t.listLimit&&(t.listLimit=t.listLimit+1,t.setWidgetHeight(t.currentHeight+t.rowHeight)),t.events[e].betOffers[0].outcomes[t.events[e].betOffers[0].lowestOutcome].selected=!0,t.calculateCombinedOdds(),!0;s+=1}return!1},t.resetSelection=function(){for(var e=0,o=t.events.length,s=0;o>e;++e)for(var n=0,r=t.events[e].betOffers[0].outcomes.length;r>n;++n)s<t.args.defaultListLimit&&n===t.events[e].betOffers[0].lowestOutcome?(t.events[e].betOffers[0].outcomes[n].selected=!0,s+=1):t.events[e].betOffers[0].outcomes[n].selected=!1;t.listLimit=t.args.defaultListLimit,t.setWidgetHeight(t.defaultHeight),t.calculateCombinedOdds()},t.setLowerOddsLimit=function(e){e>0&&(t.lowerOddsLimit=e)},t.selectOutcome=function(e,o){for(var s=0,n=o.length;n>s;++s)o[s].selected=!1;e.selected=!0,t.calculateCombinedOdds()},t.navigateToEvent=function(e){o.navigateToEvent(e)},t.init().then(function(){t.getBetoffersByFilter(t.args.filter),t.currentHeight=450,t.setWidgetHeight(t.currentHeight)}),t.$watch("oddsFormat",function(){t.calculateCombinedOdds()})}!function(t){return t.controller("appController",["$scope","kambiWidgetService","kambiAPIService","$controller","$http",e])}(angular.module("comboWidget"))}.call(this);